{"timestamp":"2025-12-07T14:43:29.937222Z","level":"info","event":"DAG bundles loaded: dags-folder","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2025-12-07T14:43:29.940350Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/etl_batch_dag.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2025-12-07T14:43:31.386993Z","level":"warning","event":"The `airflow.operators.email.EmailOperator` attribute is deprecated. Please use `'airflow.providers.smtp.operators.smtp.EmailOperator'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/etl_batch_dag.py","lineno":3,"logger":"py.warnings"}
{"timestamp":"2025-12-07T14:43:31.387366Z","level":"warning","event":"No system locale set. Falling back to 'en_US'. Set LANG/LC_ALL or pass locale_code to override.","category":"UserWarning","filename":"/home/airflow/.local/lib/python3.12/site-packages/cron_descriptor/ExpressionDescriptor.py","lineno":69,"logger":"py.warnings"}
{"timestamp":"2025-12-07T14:43:31.441808Z","level":"info","event":"Connecting to Kafka: kafka:29092, Topic: iot_sensor_data","logger":"unusual_prefix_7edc9e386923eac33e5780a0324ec7ae73b4fe07_etl_batch_dag","filename":"etl_batch_dag.py","lineno":34}
{"timestamp":"2025-12-07T14:43:31.446036Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: connecting to kafka:29092 [('172.19.0.6', 29092) IPv4]","logger":"kafka.conn","filename":"conn.py","lineno":396}
{"timestamp":"2025-12-07T14:43:31.460309Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=kafka:29092 <checking_api_versions_recv> [IPv4 ('172.19.0.6', 29092)]>: Broker version identified as 2.6","logger":"kafka.conn","filename":"conn.py","lineno":618}
{"timestamp":"2025-12-07T14:43:31.461916Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.19.0.6', 29092)]>: Connection complete.","logger":"kafka.conn","filename":"conn.py","lineno":457}
{"timestamp":"2025-12-07T14:43:31.464165Z","level":"info","event":"Updating subscribed topics to: ('iot_sensor_data',)","logger":"kafka.consumer.subscription_state","filename":"subscription_state.py","lineno":181}
{"timestamp":"2025-12-07T14:43:31.464398Z","level":"info","event":"Starting message consumption...","logger":"unusual_prefix_7edc9e386923eac33e5780a0324ec7ae73b4fe07_etl_batch_dag","filename":"etl_batch_dag.py","lineno":55}
{"timestamp":"2025-12-07T14:43:31.468326Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: connecting to kafka:29092 [('172.19.0.6', 29092) IPv4]","logger":"kafka.conn","filename":"conn.py","lineno":396}
{"timestamp":"2025-12-07T14:43:31.468952Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.19.0.6', 29092)]>: Connection complete.","logger":"kafka.conn","filename":"conn.py","lineno":457}
{"timestamp":"2025-12-07T14:43:31.469280Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.19.0.6', 29092)]>: Closing connection. ","logger":"kafka.conn","filename":"conn.py","lineno":945}
{"timestamp":"2025-12-07T14:43:33.862093Z","level":"info","event":"Coordinator for group/batch-processor-group is BrokerMetadata(nodeId='coordinator-1', host='kafka', port=29092, rack=None)","logger":"kafka.cluster","filename":"cluster.py","lineno":401}
{"timestamp":"2025-12-07T14:43:33.862387Z","level":"info","event":"Discovered coordinator coordinator-1 for group batch-processor-group","logger":"kafka.coordinator","filename":"base.py","lineno":788}
{"timestamp":"2025-12-07T14:43:33.862604Z","level":"info","event":"Starting new heartbeat thread","logger":"kafka.coordinator.heartbeat","filename":"base.py","lineno":848}
{"timestamp":"2025-12-07T14:43:33.864284Z","level":"info","event":"Revoking previously assigned partitions set() for group batch-processor-group","logger":"kafka.coordinator.consumer","filename":"consumer.py","lineno":365}
{"timestamp":"2025-12-07T14:43:33.864521Z","level":"info","event":"Failed to join group batch-processor-group: NodeNotReadyError: coordinator-1","logger":"kafka.coordinator","filename":"base.py","lineno":419}
{"timestamp":"2025-12-07T14:43:33.865830Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=coordinator-1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: connecting to kafka:29092 [('172.19.0.6', 29092) IPv4]","logger":"kafka.conn","filename":"conn.py","lineno":396}
{"timestamp":"2025-12-07T14:43:33.866389Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=coordinator-1 host=kafka:29092 <connected> [IPv4 ('172.19.0.6', 29092)]>: Connection complete.","logger":"kafka.conn","filename":"conn.py","lineno":457}
{"timestamp":"2025-12-07T14:43:33.967981Z","level":"info","event":"(Re-)joining group batch-processor-group","logger":"kafka.coordinator","filename":"base.py","lineno":532}
{"timestamp":"2025-12-07T14:43:34.013760Z","level":"info","event":"Received member id kafka-python-2.2.15-12638fc2-db39-4c41-bc99-665edaebb401 for group batch-processor-group; will retry join-group","logger":"kafka.coordinator","filename":"base.py","lineno":637}
{"timestamp":"2025-12-07T14:43:34.014129Z","level":"info","event":"Failed to join group batch-processor-group: [Error 79] MemberIdRequiredError","logger":"kafka.coordinator","filename":"base.py","lineno":419}
{"timestamp":"2025-12-07T14:43:34.014496Z","level":"info","event":"(Re-)joining group batch-processor-group","logger":"kafka.coordinator","filename":"base.py","lineno":532}
{"timestamp":"2025-12-07T14:43:34.069559Z","level":"info","event":"Successfully joined group batch-processor-group <Generation 1 (member_id: kafka-python-2.2.15-12638fc2-db39-4c41-bc99-665edaebb401, protocol: range)>","logger":"kafka.coordinator","filename":"base.py","lineno":594}
{"timestamp":"2025-12-07T14:43:34.069876Z","level":"info","event":"Elected group leader -- performing partition assignments using range","logger":"kafka.coordinator","filename":"base.py","lineno":596}
{"timestamp":"2025-12-07T14:43:34.128238Z","level":"info","event":"Updated partition assignment: [TopicPartition(topic='iot_sensor_data', partition=0)]","logger":"kafka.consumer.subscription_state","filename":"subscription_state.py","lineno":254}
{"timestamp":"2025-12-07T14:43:34.129088Z","level":"info","event":"Setting newly assigned partitions {TopicPartition(topic='iot_sensor_data', partition=0)} for group batch-processor-group","logger":"kafka.coordinator.consumer","filename":"consumer.py","lineno":249}
{"timestamp":"2025-12-07T14:43:34.162102Z","level":"info","event":"Resetting offset for partition TopicPartition(topic='iot_sensor_data', partition=0) to offset 0.","logger":"kafka.consumer.fetcher","filename":"fetcher.py","lineno":418}
{"timestamp":"2025-12-07T14:43:34.177491Z","level":"info","event":"Consumed 100 messages so far...","logger":"unusual_prefix_7edc9e386923eac33e5780a0324ec7ae73b4fe07_etl_batch_dag","filename":"etl_batch_dag.py","lineno":65}
{"timestamp":"2025-12-07T14:48:23.376194Z","level":"info","event":"Consumed 200 messages so far...","logger":"unusual_prefix_7edc9e386923eac33e5780a0324ec7ae73b4fe07_etl_batch_dag","filename":"etl_batch_dag.py","lineno":65}
{"timestamp":"2025-12-07T14:53:05.862104Z","level":"info","event":"Consumed 300 messages so far...","logger":"unusual_prefix_7edc9e386923eac33e5780a0324ec7ae73b4fe07_etl_batch_dag","filename":"etl_batch_dag.py","lineno":65}
{"timestamp":"2025-12-07T14:53:34.739464Z","level":"warning","event":"Heartbeat failed for group batch-processor-group because it is rebalancing","logger":"kafka.coordinator.heartbeat","filename":"base.py","lineno":951}
{"timestamp":"2025-12-07T14:53:34.745561Z","level":"info","event":"Revoking previously assigned partitions {TopicPartition(topic='iot_sensor_data', partition=0)} for group batch-processor-group","logger":"kafka.coordinator.consumer","filename":"consumer.py","lineno":365}
{"timestamp":"2025-12-07T14:53:34.747089Z","level":"info","event":"(Re-)joining group batch-processor-group","logger":"kafka.coordinator","filename":"base.py","lineno":532}
{"timestamp":"2025-12-07T14:53:34.765518Z","level":"info","event":"Successfully joined group batch-processor-group <Generation 2 (member_id: kafka-python-2.2.15-12638fc2-db39-4c41-bc99-665edaebb401, protocol: range)>","logger":"kafka.coordinator","filename":"base.py","lineno":594}
{"timestamp":"2025-12-07T14:53:34.766204Z","level":"info","event":"Elected group leader -- performing partition assignments using range","logger":"kafka.coordinator","filename":"base.py","lineno":596}
{"timestamp":"2025-12-07T14:53:34.786987Z","level":"info","event":"Updated partition assignment: [TopicPartition(topic='iot_sensor_data', partition=0)]","logger":"kafka.consumer.subscription_state","filename":"subscription_state.py","lineno":254}
{"timestamp":"2025-12-07T14:53:34.787810Z","level":"info","event":"Setting newly assigned partitions {TopicPartition(topic='iot_sensor_data', partition=0)} for group batch-processor-group","logger":"kafka.coordinator.consumer","filename":"consumer.py","lineno":249}
{"timestamp":"2025-12-07T14:53:40.792260Z","level":"warning","event":"Heartbeat failed for group batch-processor-group because it is rebalancing","logger":"kafka.coordinator.heartbeat","filename":"base.py","lineno":951}
{"timestamp":"2025-12-07T14:53:40.797781Z","level":"info","event":"Revoking previously assigned partitions {TopicPartition(topic='iot_sensor_data', partition=0)} for group batch-processor-group","logger":"kafka.coordinator.consumer","filename":"consumer.py","lineno":365}
{"timestamp":"2025-12-07T14:53:40.798280Z","level":"info","event":"(Re-)joining group batch-processor-group","logger":"kafka.coordinator","filename":"base.py","lineno":532}
{"timestamp":"2025-12-07T14:53:40.802676Z","level":"info","event":"Successfully joined group batch-processor-group <Generation 3 (member_id: kafka-python-2.2.15-12638fc2-db39-4c41-bc99-665edaebb401, protocol: range)>","logger":"kafka.coordinator","filename":"base.py","lineno":594}
{"timestamp":"2025-12-07T14:53:40.803041Z","level":"info","event":"Elected group leader -- performing partition assignments using range","logger":"kafka.coordinator","filename":"base.py","lineno":596}
{"timestamp":"2025-12-07T14:53:40.810892Z","level":"info","event":"Updated partition assignment: [TopicPartition(topic='iot_sensor_data', partition=0)]","logger":"kafka.consumer.subscription_state","filename":"subscription_state.py","lineno":254}
{"timestamp":"2025-12-07T14:53:40.811635Z","level":"info","event":"Setting newly assigned partitions {TopicPartition(topic='iot_sensor_data', partition=0)} for group batch-processor-group","logger":"kafka.coordinator.consumer","filename":"consumer.py","lineno":249}
{"timestamp":"2025-12-07T14:56:30.874789Z","level":"warning","event":"Heartbeat failed for group batch-processor-group because it is rebalancing","logger":"kafka.coordinator.heartbeat","filename":"base.py","lineno":951}
{"timestamp":"2025-12-07T14:56:30.881947Z","level":"info","event":"Revoking previously assigned partitions {TopicPartition(topic='iot_sensor_data', partition=0)} for group batch-processor-group","logger":"kafka.coordinator.consumer","filename":"consumer.py","lineno":365}
{"timestamp":"2025-12-07T14:56:30.882705Z","level":"info","event":"(Re-)joining group batch-processor-group","logger":"kafka.coordinator","filename":"base.py","lineno":532}
{"timestamp":"2025-12-07T14:56:30.891475Z","level":"info","event":"Successfully joined group batch-processor-group <Generation 4 (member_id: kafka-python-2.2.15-12638fc2-db39-4c41-bc99-665edaebb401, protocol: range)>","logger":"kafka.coordinator","filename":"base.py","lineno":594}
{"timestamp":"2025-12-07T14:56:30.891719Z","level":"info","event":"Elected group leader -- performing partition assignments using range","logger":"kafka.coordinator","filename":"base.py","lineno":596}
{"timestamp":"2025-12-07T14:56:30.902783Z","level":"info","event":"Updated partition assignment: [TopicPartition(topic='iot_sensor_data', partition=0)]","logger":"kafka.consumer.subscription_state","filename":"subscription_state.py","lineno":254}
{"timestamp":"2025-12-07T14:56:30.903377Z","level":"info","event":"Setting newly assigned partitions {TopicPartition(topic='iot_sensor_data', partition=0)} for group batch-processor-group","logger":"kafka.coordinator.consumer","filename":"consumer.py","lineno":249}
{"timestamp":"2025-12-07T14:56:33.928645Z","level":"warning","event":"Heartbeat failed for group batch-processor-group because it is rebalancing","logger":"kafka.coordinator.heartbeat","filename":"base.py","lineno":951}
{"timestamp":"2025-12-07T14:56:33.933023Z","level":"info","event":"Revoking previously assigned partitions {TopicPartition(topic='iot_sensor_data', partition=0)} for group batch-processor-group","logger":"kafka.coordinator.consumer","filename":"consumer.py","lineno":365}
{"timestamp":"2025-12-07T14:56:33.933409Z","level":"info","event":"(Re-)joining group batch-processor-group","logger":"kafka.coordinator","filename":"base.py","lineno":532}
{"timestamp":"2025-12-07T14:56:33.937373Z","level":"info","event":"Successfully joined group batch-processor-group <Generation 5 (member_id: kafka-python-2.2.15-12638fc2-db39-4c41-bc99-665edaebb401, protocol: range)>","logger":"kafka.coordinator","filename":"base.py","lineno":594}
{"timestamp":"2025-12-07T14:56:33.937983Z","level":"info","event":"Elected group leader -- performing partition assignments using range","logger":"kafka.coordinator","filename":"base.py","lineno":596}
{"timestamp":"2025-12-07T14:56:33.943937Z","level":"info","event":"Updated partition assignment: [TopicPartition(topic='iot_sensor_data', partition=0)]","logger":"kafka.consumer.subscription_state","filename":"subscription_state.py","lineno":254}
{"timestamp":"2025-12-07T14:56:33.944650Z","level":"info","event":"Setting newly assigned partitions {TopicPartition(topic='iot_sensor_data', partition=0)} for group batch-processor-group","logger":"kafka.coordinator.consumer","filename":"consumer.py","lineno":249}
{"timestamp":"2025-12-07T14:58:59.177998Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.19.0.6', 29092)]>: socket disconnected","logger":"kafka.conn","filename":"conn.py","lineno":1163}
{"timestamp":"2025-12-07T14:58:59.179815Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.19.0.6', 29092)]>: Closing connection. KafkaConnectionError: socket disconnected","logger":"kafka.conn","filename":"conn.py","lineno":945}
{"timestamp":"2025-12-07T14:58:59.244343Z","level":"warning","event":"Node 1 connection failed -- refreshing metadata","logger":"kafka.client","filename":"client_async.py","lineno":388}
{"timestamp":"2025-12-07T14:58:59.246123Z","level":"error","event":"Fetch to node 1 failed: KafkaConnectionError: socket disconnected","logger":"kafka.consumer.fetcher","filename":"fetcher.py","lineno":786}
{"timestamp":"2025-12-07T14:58:59.254943Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: connecting to kafka:29092 [('172.19.0.6', 29092) IPv4]","logger":"kafka.conn","filename":"conn.py","lineno":396}
{"timestamp":"2025-12-07T14:58:59.255826Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=coordinator-1 host=kafka:29092 <connected> [IPv4 ('172.19.0.6', 29092)]>: Closing connection. KafkaConnectionError: Socket EVENT_READ without in-flight-requests","logger":"kafka.conn","filename":"conn.py","lineno":945}
{"timestamp":"2025-12-07T14:58:59.256699Z","level":"warning","event":"Node coordinator-1 connection failed -- refreshing metadata","logger":"kafka.client","filename":"client_async.py","lineno":388}
{"timestamp":"2025-12-07T14:58:59.257383Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: Connect attempt returned error 111. Disconnecting.","logger":"kafka.conn","filename":"conn.py","lineno":429}
{"timestamp":"2025-12-07T14:58:59.257753Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: Closing connection. KafkaConnectionError: 111 ECONNREFUSED","logger":"kafka.conn","filename":"conn.py","lineno":945}
{"timestamp":"2025-12-07T14:58:59.258041Z","level":"warning","event":"Node 1 connection failed -- refreshing metadata","logger":"kafka.client","filename":"client_async.py","lineno":388}
{"timestamp":"2025-12-07T14:58:59.361553Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: connecting to kafka:29092 [('172.19.0.6', 29092) IPv4]","logger":"kafka.conn","filename":"conn.py","lineno":396}
{"timestamp":"2025-12-07T14:58:59.362775Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: Connect attempt returned error 111. Disconnecting.","logger":"kafka.conn","filename":"conn.py","lineno":429}
{"timestamp":"2025-12-07T14:58:59.363241Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: Closing connection. KafkaConnectionError: 111 ECONNREFUSED","logger":"kafka.conn","filename":"conn.py","lineno":945}
{"timestamp":"2025-12-07T14:58:59.364920Z","level":"warning","event":"Node 1 connection failed -- refreshing metadata","logger":"kafka.client","filename":"client_async.py","lineno":388}
{"timestamp":"2025-12-07T14:58:59.528075Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: connecting to kafka:29092 [('172.19.0.6', 29092) IPv4]","logger":"kafka.conn","filename":"conn.py","lineno":396}
{"timestamp":"2025-12-07T14:58:59.528969Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: Connect attempt returned error 111. Disconnecting.","logger":"kafka.conn","filename":"conn.py","lineno":429}
{"timestamp":"2025-12-07T14:58:59.529237Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: Closing connection. KafkaConnectionError: 111 ECONNREFUSED","logger":"kafka.conn","filename":"conn.py","lineno":945}
{"timestamp":"2025-12-07T14:58:59.529616Z","level":"warning","event":"Node 1 connection failed -- refreshing metadata","logger":"kafka.client","filename":"client_async.py","lineno":388}
{"timestamp":"2025-12-07T14:58:59.850139Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: connecting to kafka:29092 [('172.19.0.6', 29092) IPv4]","logger":"kafka.conn","filename":"conn.py","lineno":396}
{"timestamp":"2025-12-07T14:58:59.850898Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: Connect attempt returned error 111. Disconnecting.","logger":"kafka.conn","filename":"conn.py","lineno":429}
{"timestamp":"2025-12-07T14:58:59.851142Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: Closing connection. KafkaConnectionError: 111 ECONNREFUSED","logger":"kafka.conn","filename":"conn.py","lineno":945}
{"timestamp":"2025-12-07T14:58:59.851478Z","level":"warning","event":"Node 1 connection failed -- refreshing metadata","logger":"kafka.client","filename":"client_async.py","lineno":388}
{"timestamp":"2025-12-07T14:59:00.518407Z","level":"info","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: connecting to kafka:29092 [('172.19.0.6', 29092) IPv4]","logger":"kafka.conn","filename":"conn.py","lineno":396}
{"timestamp":"2025-12-07T14:59:00.519482Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: Connect attempt returned error 111. Disconnecting.","logger":"kafka.conn","filename":"conn.py","lineno":429}
{"timestamp":"2025-12-07T14:59:00.519806Z","level":"error","event":"<BrokerConnection client_id=kafka-python-2.2.15, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.19.0.6', 29092)]>: Closing connection. KafkaConnectionError: 111 ECONNREFUSED","logger":"kafka.conn","filename":"conn.py","lineno":945}
{"timestamp":"2025-12-07T14:59:00.521422Z","level":"warning","event":"Node 1 connection failed -- refreshing metadata","logger":"kafka.client","filename":"client_async.py","lineno":388}
